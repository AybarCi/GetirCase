{"ast":null,"code":"import _objectSpread from \"/Users/Petito/ReactNativeProjects/GetirCase/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/Petito/ReactNativeProjects/GetirCase/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/Petito/ReactNativeProjects/GetirCase/src/components/BasketBadge.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Badge, Button, Box, Popper, Fade, Paper, Table, TableBody, TableCell, TableContainer, TableRow } from '@mui/material';\nimport ShoppingBasketIcon from '@mui/icons-material/ShoppingBasket';\nimport AddCircleRoundedIcon from '@mui/icons-material/AddCircleRounded';\nimport RemoveCircleRoundedIcon from '@mui/icons-material/RemoveCircleRounded';\nimport { connect } from \"react-redux\";\nimport * as basketActions from \"../store/actions/basket.actions\";\nimport linq from 'linq';\nimport items from '../data/items';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction BasketBadge(props) {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      anchorEl = _useState2[0],\n      setAnchorEl = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      open = _useState4[0],\n      setOpen = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      placement = _useState6[0],\n      setPlacement = _useState6[1];\n\n  var basketBase = props.basket;\n  var basket = linq.from(basketBase).groupBy(function (g) {\n    return g.added;\n  }, function (element) {\n    return element;\n  }, function (key, items) {\n    return {\n      key: key,\n      items: items.toArray(),\n      count: items.toArray().length,\n      sum: items.sum(function (item) {\n        return item.price;\n      })\n    };\n  }).toArray();\n\n  var handleClick = function handleClick(newPlacement) {\n    return function (event) {\n      setAnchorEl(event.currentTarget);\n      setOpen(function (prev) {\n        return placement !== newPlacement || !prev;\n      });\n      setPlacement(newPlacement);\n    };\n  };\n\n  var productListForRefresh = [];\n\n  function addProduct(item) {\n    var foundItem = linq.from(items).where(function (element) {\n      return element.added === item.key;\n    }).firstOrDefault();\n\n    if (props.basket !== null) {\n      linq.from(props.basket).forEach(function (element) {\n        productListForRefresh.push(element);\n      });\n      productListForRefresh.push(foundItem);\n    } else {\n      productListForRefresh.push(foundItem);\n    }\n\n    props.onRefreshBasket(productListForRefresh);\n  }\n\n  function removeProduct(item) {\n    var addedCount = 1;\n    var itemCount = item.count;\n\n    if (props.basket !== null) {\n      linq.from(props.basket).forEach(function (element) {\n        if (element.added !== item.key) {\n          productListForRefresh.push(element);\n        }\n\n        if (element.added === item.key) {\n          if (addedCount < itemCount) {\n            if (itemCount > 1) {\n              addedCount = addedCount + 1;\n              itemCount = itemCount - 1;\n              productListForRefresh.push(element);\n            }\n          }\n        }\n      });\n    }\n\n    props.onRefreshBasket(productListForRefresh);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      width: 500\n    },\n    children: [/*#__PURE__*/_jsxDEV(Popper, {\n      open: open,\n      anchorEl: anchorEl,\n      placement: placement,\n      transition: true,\n      children: function children(_ref) {\n        var TransitionProps = _ref.TransitionProps;\n        return /*#__PURE__*/_jsxDEV(Fade, _objectSpread(_objectSpread({}, TransitionProps), {}, {\n          timeout: 350,\n          children: /*#__PURE__*/_jsxDEV(Paper, {\n            children: /*#__PURE__*/_jsxDEV(TableContainer, {\n              component: Paper,\n              children: /*#__PURE__*/_jsxDEV(Table, {\n                sx: {\n                  minWidth: 350\n                },\n                \"aria-label\": \"simple table\",\n                children: /*#__PURE__*/_jsxDEV(TableBody, {\n                  children: [basket.map(function (item) {\n                    return /*#__PURE__*/_jsxDEV(TableRow //key={row.name}\n                    , {\n                      sx: {\n                        '&:last-child td, &:last-child th': {\n                          border: 0\n                        }\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                        component: \"th\",\n                        scope: \"row\",\n                        children: item.items[0].name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 77,\n                        columnNumber: 17\n                      }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                        component: \"th\",\n                        scope: \"row\",\n                        children: [\"$\", item.sum]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 80,\n                        columnNumber: 17\n                      }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                        align: \"right\",\n                        children: /*#__PURE__*/_jsxDEV(Button, {\n                          onClick: function onClick() {\n                            return removeProduct(item);\n                          },\n                          children: /*#__PURE__*/_jsxDEV(RemoveCircleRoundedIcon, {\n                            color: \"secondary\",\n                            sx: \"small\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 85,\n                            columnNumber: 21\n                          }, _this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 84,\n                          columnNumber: 19\n                        }, _this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 83,\n                        columnNumber: 17\n                      }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                        align: \"right\",\n                        children: item.count\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 88,\n                        columnNumber: 17\n                      }, _this), /*#__PURE__*/_jsxDEV(TableCell, {\n                        align: \"right\",\n                        children: /*#__PURE__*/_jsxDEV(Button, {\n                          onClick: function onClick() {\n                            return addProduct(item);\n                          },\n                          children: /*#__PURE__*/_jsxDEV(AddCircleRoundedIcon, {\n                            color: \"secondary\",\n                            sx: \"small\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 91,\n                            columnNumber: 21\n                          }, _this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 90,\n                          columnNumber: 19\n                        }, _this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 89,\n                        columnNumber: 17\n                      }, _this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 73,\n                      columnNumber: 15\n                    }, _this);\n                  }), /*#__PURE__*/_jsxDEV(TableRow, {\n                    children: /*#__PURE__*/_jsxDEV(TableCell, {\n                      align: \"left\",\n                      children: [\"Total Price: $\", linq.from(basket).sum(function (item) {\n                        return item.sum;\n                      })]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 98,\n                      columnNumber: 13\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 97,\n                    columnNumber: 11\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 70,\n                  columnNumber: 9\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 69,\n                columnNumber: 7\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 13\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, _this)\n        }), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, _this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: handleClick('bottom-end'),\n      children: props.basket == null ? /*#__PURE__*/_jsxDEV(Badge, {\n        badgeContent: 0,\n        color: \"secondary\",\n        children: /*#__PURE__*/_jsxDEV(ShoppingBasketIcon, {\n          color: \"secondary\",\n          sx: {\n            fontSize: 40\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Badge, {\n        badgeContent: props.basket.length,\n        color: \"secondary\",\n        children: /*#__PURE__*/_jsxDEV(ShoppingBasketIcon, {\n          color: \"secondary\",\n          sx: {\n            fontSize: 40\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BasketBadge, \"HartJ7tQ+4oOW4zlp9lSi524e5M=\");\n\n_c = BasketBadge;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    basket: state.basket.basket,\n    products: state.product.products\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    onRefreshBasket: function onRefreshBasket(basket) {\n      return dispatch(basketActions.refreshBasket(basket));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(BasketBadge);\n\nvar _c;\n\n$RefreshReg$(_c, \"BasketBadge\");","map":{"version":3,"sources":["/Users/Petito/ReactNativeProjects/GetirCase/src/components/BasketBadge.js"],"names":["React","useState","Badge","Button","Box","Popper","Fade","Paper","Table","TableBody","TableCell","TableContainer","TableRow","ShoppingBasketIcon","AddCircleRoundedIcon","RemoveCircleRoundedIcon","connect","basketActions","linq","items","BasketBadge","props","anchorEl","setAnchorEl","open","setOpen","placement","setPlacement","basketBase","basket","from","groupBy","g","added","element","key","toArray","count","length","sum","item","price","handleClick","newPlacement","event","currentTarget","prev","productListForRefresh","addProduct","foundItem","where","firstOrDefault","forEach","push","onRefreshBasket","removeProduct","addedCount","itemCount","width","TransitionProps","minWidth","map","border","name","fontSize","mapStateToProps","state","products","product","mapDispatchToProps","dispatch","refreshBasket"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport {Badge,Button,Box,Popper,Fade,Paper,Table,TableBody,TableCell,TableContainer,TableRow} from '@mui/material';\r\nimport ShoppingBasketIcon from '@mui/icons-material/ShoppingBasket';\r\nimport AddCircleRoundedIcon from '@mui/icons-material/AddCircleRounded';\r\nimport RemoveCircleRoundedIcon from '@mui/icons-material/RemoveCircleRounded';\r\nimport { connect } from \"react-redux\";\r\nimport * as basketActions from \"../store/actions/basket.actions\";\r\nimport linq from 'linq';\r\nimport items from '../data/items';\r\n\r\n\r\nfunction BasketBadge(props) {\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const [open, setOpen] = useState(false);\r\n  const [placement, setPlacement] = useState();\r\n  \r\n  let basketBase = props.basket;\r\n  let basket = linq.from(basketBase)\r\n  .groupBy(g => g.added, element => element, (key,items) =>({\r\n    key, items: items.toArray(), count: items.toArray().length, sum: items.sum(item => item.price)})).toArray();\r\n\r\n  const handleClick = (newPlacement) => (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n    setOpen((prev) => placement !== newPlacement || !prev);\r\n    setPlacement(newPlacement);\r\n  };\r\n\r\n  let productListForRefresh = [];\r\n  function addProduct(item){\r\n    let foundItem = linq.from(items).where(element => element.added === item.key).firstOrDefault();\r\n    if (props.basket !== null) {\r\n      linq.from(props.basket).forEach(element => {\r\n        productListForRefresh.push(element)\r\n      })\r\n      productListForRefresh.push(foundItem);\r\n    } else {\r\n      productListForRefresh.push(foundItem);\r\n    }\r\n    props.onRefreshBasket(productListForRefresh);\r\n  }\r\n  function removeProduct(item) {\r\n    let addedCount = 1;\r\n    let itemCount = item.count;\r\n    if (props.basket !== null) {\r\n      linq.from(props.basket).forEach(element => {\r\n        if (element.added !== item.key) {\r\n          productListForRefresh.push(element)  \r\n        }\r\n        if (element.added === item.key) {\r\n          if (addedCount < itemCount) {\r\n            if (itemCount > 1) {\r\n              addedCount = addedCount + 1;\r\n              itemCount = itemCount -1\r\n              productListForRefresh.push(element);  \r\n            }\r\n          }\r\n        } \r\n      }) \r\n    }\r\n    props.onRefreshBasket(productListForRefresh);\r\n  }\r\n  return (\r\n    <Box sx={{ width: 500 }}>\r\n    <Popper open={open} anchorEl={anchorEl} placement={placement} transition>\r\n        {({ TransitionProps }) => (\r\n          <Fade {...TransitionProps} timeout={350}>\r\n            <Paper>\r\n            <TableContainer component={Paper}>\r\n      <Table sx={{ minWidth: 350 }} aria-label=\"simple table\">\r\n        <TableBody>\r\n          {basket.map(item => {\r\n            return(\r\n              <TableRow\r\n              //key={row.name}\r\n              sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n              >\r\n                <TableCell component=\"th\" scope=\"row\">\r\n                  {item.items[0].name}\r\n                </TableCell>\r\n                <TableCell component=\"th\" scope=\"row\">\r\n                  ${item.sum}\r\n                </TableCell>\r\n                <TableCell align=\"right\">\r\n                  <Button onClick={() => removeProduct(item)}>\r\n                    <RemoveCircleRoundedIcon color=\"secondary\" sx=\"small\"/>\r\n                  </Button>\r\n                </TableCell>\r\n                <TableCell align=\"right\">{item.count}</TableCell>\r\n                <TableCell align=\"right\">\r\n                  <Button onClick={() => addProduct(item)}>\r\n                    <AddCircleRoundedIcon color=\"secondary\" sx=\"small\"/>\r\n                  </Button>\r\n                </TableCell>\r\n              </TableRow>\r\n            ) \r\n          })}\r\n          <TableRow>\r\n            <TableCell align=\"left\">\r\n              Total Price: ${linq.from(basket).sum(item => item.sum)}\r\n            </TableCell>\r\n          </TableRow>\r\n        </TableBody>\r\n      </Table>\r\n    </TableContainer>\r\n            </Paper>\r\n          </Fade>\r\n        )}\r\n      </Popper>\r\n      <Button onClick={handleClick('bottom-end')}>\r\n        {props.basket == null ? (\r\n          <Badge badgeContent={0} color=\"secondary\">\r\n            <ShoppingBasketIcon color=\"secondary\" sx={{ fontSize: 40 }}/>\r\n          </Badge>\r\n        ) : (\r\n          <Badge badgeContent={props.basket.length} color=\"secondary\">\r\n            <ShoppingBasketIcon color=\"secondary\" sx={{ fontSize: 40 }}/>\r\n          </Badge>\r\n        )}\r\n        \r\n      </Button>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  const mapStateToProps = (state) => {\r\n    return {\r\n      basket: state.basket.basket,\r\n      products: state.product.products,\r\n    };\r\n  };\r\n  \r\n  const mapDispatchToProps = (dispatch) => {\r\n    return {\r\n      onRefreshBasket: (\r\n        basket\r\n      ) =>\r\n        dispatch(\r\n          basketActions.refreshBasket(\r\n            basket\r\n          )\r\n        ),\r\n    };\r\n  };\r\n  export default connect(mapStateToProps, mapDispatchToProps)(BasketBadge);"]},"metadata":{},"sourceType":"module"}